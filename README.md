# PCI规划工具增强版

## 项目简介

本项目是PCI规划工具的增强版本，主要解决了原版工具中存在的几个关键问题，并进行了性能优化。

## 主要功能

1. **PCI规划** - 根据现网工参和待规划小区数据生成PCI规划方案
2. **现网工参更新** - 更新全量工参文件中的现网数据

## 增强与修复内容

### 1. NR工参更新优化
- 修复了移动网络码（MNC）列第2行和第3行数据被错误修改的问题
- 修复了gNodeBLength列第2行和第3行数据被错误修改的问题
- 确保默认值填充只作用于数据行，保护表头行不被修改
- 修复了移动网络码强制设置为"11"的问题，现在根据现网工参匹配更新

### 2. LTE工参更新优化
- 保持了原有的合并键生成和匹配逻辑
- 确保所有eNodeB标识的小区都能正确匹配

### 3. 性能优化
- 移除了不必要的颜色填充功能，显著提高处理速度
- 减少了内存使用量

## 使用方法

1. 运行程序：
   ```
   python pci_planning_lte_nr_enhanced.py
   ```

2. 根据菜单选择功能：
   - 选项1：进行PCI规划
   - 选项2：更新现网工参
   - 选项3：退出程序

## 文件结构

```
PCI规划/
├── pci_planning_lte_nr_enhanced.py  # 主程序文件
├── 全量工参/                        # 全量工参文件目录
├── 待规划小区/                      # 待规划小区数据目录
├── 现网工参/                        # 现网工参文件目录
└── 输出文件/                        # 程序输出文件目录
```

## 输出文件

程序会生成以下输出文件：
1. PCI规划结果文件（带有时间戳）
2. 更新后的工参文件（带有时间戳）

## 技术细节

### 关键改进点

1. **NR默认值填充优化**：
   - `_fill_mnc_from_plmn`函数只处理数据行（索引3及以上）
   - `_fill_gnodeb_length`函数只处理数据行（索引3及以上）

2. **颜色填充功能移除**：
   - 删除了`_apply_cell_formatting`函数的调用
   - 移除了所有与颜色相关的代码
   - 保留了函数结构但移除了实际功能

## 测试验证

所有增强和修复都经过了完整的测试验证：
- NR工参更新修复验证通过
- LTE工参更新修复验证通过
- 颜色填充功能移除验证通过
- 程序运行正常，无错误输出

## 性能提升

相比原版工具，增强版在以下方面有显著提升：
- 处理时间减少（移除了不必要的颜色填充功能）
- 内存使用量降低
- 数据处理准确性提高

## 依赖库

- pandas
- openpyxl
- numpy

## 版本信息

- 版本：增强版 1.0
- 日期：2025年9月

## 维护说明

如需维护或进一步开发，请参考以下文件：
- `IMPLEMENTATION_SUMMARY.md` - 实现细节说明
- `FIX_SUMMARY.md` - 修复总结报告
- `TEST_REPORT.md` - 测试报告